import{r as i,c as C,i as E,j as e}from"./index-BX1Ylhwe.js";const F=()=>{const[a,x]=i.useState(!0),[r,h]=i.useState({name:"",email:"",password:""}),[f,s]=i.useState(""),[j,d]=i.useState(""),o=C(),{login:y,logout:S,user:l}=E();i.useEffect(()=>{l&&o("/")},[l,o]);const b=()=>{x(!a),h({name:"",email:"",password:""}),s(""),d("")},u=t=>{h({...r,[t.target.name]:t.target.value})},w=t=>/^[^\s@]+@[^\s@]+\.[^\s@]+$/.test(String(t).toLowerCase()),v=async t=>{t.preventDefault();const{name:m,email:g,password:p}=r;if(!w(g)){s("Please enter a valid email address.");return}if(p.length<6){s("Password must be at least 6 characters long.");return}try{if(a){const n=await fetch("https://backend-testofindia.onrender.com/api/auth/login",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({email:g,password:p})}),c=await n.json();if(n.ok){s(""),d("Logged in successfully!"),alert("Login successful!");const{token:L,user:k}=c;y(k),localStorage.setItem("authToken",L),o("/")}else s(c.message||"Login failed. Please try again.")}else{if(!m){s("Please enter your name.");return}const n=await fetch("https://backend-testofindia.onrender.com/api/auth/signup",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({name:m,email:g,password:p})}),c=await n.json();n.ok?(s(""),d("Signed up successfully!"),alert("Signup successful!")):s(c.message||"Signup failed. Please try again.")}}catch(n){console.error("Error during authentication:",n),s("An error occurred. Please try again later.")}},N=()=>{S(),o("/")};return e.jsx("div",{className:"login-signup-container",children:e.jsx("div",{className:"form-wrapper",children:l?e.jsxs(e.Fragment,{children:[e.jsxs("h2",{children:["Welcome, ",l.name,"!"]})," ",e.jsx("button",{onClick:N,className:"logout-btn",children:"Logout"})," ",e.jsx("button",{onClick:()=>o("/add-recipe"),className:"add-recipe-btn",children:"Add Recipe"})," "]}):e.jsxs(e.Fragment,{children:[e.jsx("h2",{children:a?"Login":"Sign Up"}),e.jsxs("form",{onSubmit:v,children:[!a&&e.jsxs("div",{className:"form-group",children:[e.jsx("label",{htmlFor:"name",children:"Name"}),e.jsx("input",{type:"text",id:"name",name:"name",value:r.name,onChange:u,placeholder:"Enter your name",required:!a})]}),e.jsxs("div",{className:"form-group",children:[e.jsx("label",{htmlFor:"email",children:"Email"}),e.jsx("input",{type:"email",id:"email",name:"email",value:r.email,onChange:u,placeholder:"Enter your email",required:!0})]}),e.jsxs("div",{className:"form-group",children:[e.jsx("label",{htmlFor:"password",children:"Password"}),e.jsx("input",{type:"password",id:"password",name:"password",value:r.password,onChange:u,placeholder:"Enter your password",required:!0})]}),f&&e.jsx("p",{className:"error-message",children:f})," ",j&&e.jsx("p",{className:"success-message",children:j})," ",e.jsx("button",{type:"submit",className:"submit-btn",children:a?"Login":"Sign Up"})]}),e.jsxs("p",{className:"toggle-text",children:[a?"Don't have an account?":"Already have an account?",e.jsx("span",{onClick:b,className:"toggle-link",children:a?"Sign up":"Login"})]})]})})})};export{F as default};
